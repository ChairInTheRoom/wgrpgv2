<?php

class DialogConditionFactory {

	public static function evaluateCondition($strCondition){
		if(strpos($strCondition, '&')){
			$strSplit = explode('&', $strCondition);
			$intSplitCount = count($strSplit);
			$blnValue = array();
			for($i = 0; $i < $intSplitCount; $i++){
				$blnValue[$i] = self::evaluateCondition($strSplit[$i]);
				if($blnValue[$i] == false){
					return false;
				}
			}
			return true;
		}
		else{
			if(strpos($strCondition, '>')){
				$variable = explode('>', $strCondition);
				$function = 'get' . $variable[0];
				return (intval($_SESSION['objRPGCharacter']->$function()) > intval($variable[1]));
			}
			else if(strpos($strCondition, '<')){
				$variable = explode('<', $strCondition);
				$function = 'get' . $variable[0];
				return (intval($_SESSION['objRPGCharacter']->$function()) < intval($variable[1]));
			}
			else if(strpos($strCondition, '>=')){
				$variable = explode('>', $strCondition);
				$function = 'get' . $variable[0];
				return (intval($_SESSION['objRPGCharacter']->$function()) >= intval($variable[1]));
			}
			else if(strpos($strCondition, '<=')){
				$variable = explode('>', $strCondition);
				$function = 'get' . $variable[0];
				return (intval($_SESSION['objRPGCharacter']->$function()) <= intval($variable[1]));
			}
			else if(strpos($strCondition, '=')){
				$variable = explode('>', $strCondition);
				$function = 'get' . $variable[0];
				return (intval($_SESSION['objRPGCharacter']->$function()) == intval($variable[1]));
			}
		}
	}
	
	public static function evaluateAction($strAction){
		if(strpos($strAction, '+')){
			$variable = explode('+', $strAction);
			$function = 'set' . $variable[0];
			$_SESSION['objRPGCharacter']->$function(intval($_SESSION['objRPGCharacter']->getWeight()) + intval($variable[1]));
		}
		else if(strpos($strAction, '-')){
			$variable = explode('-', $strAction);
			$function = 'set' . $variable[0];
			$_SESSION['objRPGCharacter']->$function(intval($_SESSION['objRPGCharacter']->getWeight()) - intval($variable[1]));
		}
		else if(strpos($strAction, '*')){
			$variable = explode('*', $strAction);
			$function = 'set' . $variable[0];
			$_SESSION['objRPGCharacter']->$function(floatval($variable[1]) * floatval($_SESSION['objRPGCharacter']->getWeight()));
		}
		else if(strpos($strAction, '~')){
			$function = explode('~', $strAction);
			$_SESSION['objRPGCharacter']->$function[0]($function[1]);
		}
	}
}

?>